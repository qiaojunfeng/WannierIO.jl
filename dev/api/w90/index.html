<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wannier90 · WannierIO.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WannierIO.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../convention/">Convention</a></li><li><a class="tocitem" href="../util/">Utilities</a></li><li class="is-active"><a class="tocitem" href>Wannier90</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Read/write"><span>Read/write</span></a></li></ul></li><li><a class="tocitem" href="../volumetric/">Volumetric data</a></li><li><a class="tocitem" href="../qe/">Quantum ESPRESSO</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Wannier90</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wannier90</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/main/docs/src/api/w90.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Wannier90-files"><a class="docs-heading-anchor" href="#Wannier90-files">Wannier90 files</a><a id="Wannier90-files-1"></a><a class="docs-heading-anchor-permalink" href="#Wannier90-files" title="Permalink"></a></h1><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Some of the functions, e.g. <a href="#WannierIO.read_amn-Tuple{AbstractString}"><code>read_amn</code></a>, <a href="#WannierIO.write_amn-Tuple{AbstractString, AbstractVector, AbstractString}"><code>write_amn</code></a>, <a href="#WannierIO.read_chk-Tuple{AbstractString}"><code>read_chk</code></a>, <a href="#WannierIO.write_chk-Tuple{AbstractString, WannierIO.Chk}"><code>write_chk</code></a>, etc., support reading/writing Fortran unformatted files. However, the Fortran unformatted files are machine and compiler dependent. Therefore, it is not guaranteed that these functions work for all the cases. Currently, the functions are tested on the following platforms:</p><ul><li>Linux + gfortran 11.2</li></ul></div></div><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Wannier90-files">Wannier90 files</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Read/write">Read/write</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#WannierIO.Chk"><code>WannierIO.Chk</code></a></li><li><a href="#Base.isapprox-Tuple{WannierIO.Chk, WannierIO.Chk}"><code>Base.isapprox</code></a></li><li><a href="#WannierIO._fix_win!-Tuple{Dict}"><code>WannierIO._fix_win!</code></a></li><li><a href="#WannierIO._read_amn_bin-Tuple{AbstractString}"><code>WannierIO._read_amn_bin</code></a></li><li><a href="#WannierIO._read_amn_fmt-Tuple{AbstractString}"><code>WannierIO._read_amn_fmt</code></a></li><li><a href="#WannierIO._read_chk_bin-Tuple{AbstractString}"><code>WannierIO._read_chk_bin</code></a></li><li><a href="#WannierIO._read_chk_fmt-Tuple{AbstractString}"><code>WannierIO._read_chk_fmt</code></a></li><li><a href="#WannierIO._read_eig_bin-Tuple{AbstractString}"><code>WannierIO._read_eig_bin</code></a></li><li><a href="#WannierIO._read_eig_fmt-Tuple{AbstractString}"><code>WannierIO._read_eig_fmt</code></a></li><li><a href="#WannierIO._read_mmn_bin-Tuple{AbstractString}"><code>WannierIO._read_mmn_bin</code></a></li><li><a href="#WannierIO._read_mmn_fmt-Tuple{AbstractString}"><code>WannierIO._read_mmn_fmt</code></a></li><li><a href="#WannierIO._read_nnkp_toml-Tuple{AbstractString}"><code>WannierIO._read_nnkp_toml</code></a></li><li><a href="#WannierIO._read_unk_bin-Tuple{AbstractString}"><code>WannierIO._read_unk_bin</code></a></li><li><a href="#WannierIO._read_unk_fmt-Tuple{AbstractString}"><code>WannierIO._read_unk_fmt</code></a></li><li><a href="#WannierIO._read_win_toml-Tuple{AbstractString}"><code>WannierIO._read_win_toml</code></a></li><li><a href="#WannierIO._reshape_eig-Tuple{AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Real}}"><code>WannierIO._reshape_eig</code></a></li><li><a href="#WannierIO._write_amn_bin-Tuple{AbstractString, AbstractVector, AbstractString}"><code>WannierIO._write_amn_bin</code></a></li><li><a href="#WannierIO._write_amn_fmt-Tuple{AbstractString, AbstractVector, AbstractString}"><code>WannierIO._write_amn_fmt</code></a></li><li><a href="#WannierIO._write_chk_bin-Tuple{AbstractString, WannierIO.Chk}"><code>WannierIO._write_chk_bin</code></a></li><li><a href="#WannierIO._write_chk_fmt-Tuple{AbstractString, WannierIO.Chk}"><code>WannierIO._write_chk_fmt</code></a></li><li><a href="#WannierIO._write_eig_bin-Tuple{AbstractString, AbstractVector}"><code>WannierIO._write_eig_bin</code></a></li><li><a href="#WannierIO._write_eig_fmt-Tuple{AbstractString, AbstractVector}"><code>WannierIO._write_eig_fmt</code></a></li><li><a href="#WannierIO._write_mmn_bin-Tuple{AbstractString, AbstractVector, AbstractVector, AbstractVector, AbstractString}"><code>WannierIO._write_mmn_bin</code></a></li><li><a href="#WannierIO._write_mmn_fmt-Tuple{AbstractString, AbstractVector, AbstractVector, AbstractVector, AbstractString}"><code>WannierIO._write_mmn_fmt</code></a></li><li><a href="#WannierIO._write_nnkp_toml-Tuple{AbstractString}"><code>WannierIO._write_nnkp_toml</code></a></li><li><a href="#WannierIO._write_unk_bin-Tuple{AbstractString, Integer, Array{&lt;:Complex, 5}}"><code>WannierIO._write_unk_bin</code></a></li><li><a href="#WannierIO._write_unk_fmt-Tuple{AbstractString, Integer, Array{&lt;:Complex, 5}}"><code>WannierIO._write_unk_fmt</code></a></li><li><a href="#WannierIO._write_win_toml-Tuple{AbstractString}"><code>WannierIO._write_win_toml</code></a></li><li><a href="#WannierIO.get_U-Tuple{WannierIO.Chk}"><code>WannierIO.get_U</code></a></li><li><a href="#WannierIO.get_Udis-Tuple{WannierIO.Chk}"><code>WannierIO.get_Udis</code></a></li><li><a href="#WannierIO.read_amn-Tuple{AbstractString}"><code>WannierIO.read_amn</code></a></li><li><a href="#WannierIO.read_chk-Tuple{AbstractString}"><code>WannierIO.read_chk</code></a></li><li><a href="#WannierIO.read_eig-Tuple{AbstractString}"><code>WannierIO.read_eig</code></a></li><li><a href="#WannierIO.read_mmn-Tuple{AbstractString}"><code>WannierIO.read_mmn</code></a></li><li><a href="#WannierIO.read_nnkp-Tuple{AbstractString}"><code>WannierIO.read_nnkp</code></a></li><li><a href="#WannierIO.read_spn-Tuple{AbstractString}"><code>WannierIO.read_spn</code></a></li><li><a href="#WannierIO.read_unk-Tuple{AbstractString}"><code>WannierIO.read_unk</code></a></li><li><a href="#WannierIO.read_w90_band-Tuple{AbstractString}"><code>WannierIO.read_w90_band</code></a></li><li><a href="#WannierIO.read_w90_band_dat-Tuple{AbstractString}"><code>WannierIO.read_w90_band_dat</code></a></li><li><a href="#WannierIO.read_w90_band_kpt-Tuple{AbstractString}"><code>WannierIO.read_w90_band_kpt</code></a></li><li><a href="#WannierIO.read_w90_band_labelinfo-Tuple{AbstractString}"><code>WannierIO.read_w90_band_labelinfo</code></a></li><li><a href="#WannierIO.read_w90_tbdat-Tuple{AbstractString}"><code>WannierIO.read_w90_tbdat</code></a></li><li><a href="#WannierIO.read_w90_wsvec-Tuple{AbstractString}"><code>WannierIO.read_w90_wsvec</code></a></li><li><a href="#WannierIO.read_win-Tuple{AbstractString}"><code>WannierIO.read_win</code></a></li><li><a href="#WannierIO.read_wout-Tuple{AbstractString}"><code>WannierIO.read_wout</code></a></li><li><a href="#WannierIO.write_HH_R-Union{Tuple{IT}, Tuple{T}, Tuple{AbstractString, AbstractArray{T, 3}, AbstractMatrix{IT}}} where {T&lt;:Complex, IT&lt;:Integer}"><code>WannierIO.write_HH_R</code></a></li><li><a href="#WannierIO.write_amn-Tuple{AbstractString, AbstractVector}"><code>WannierIO.write_amn</code></a></li><li><a href="#WannierIO.write_amn-Tuple{AbstractString, AbstractVector, AbstractString}"><code>WannierIO.write_amn</code></a></li><li><a href="#WannierIO.write_chk-Tuple{AbstractString, WannierIO.Chk}"><code>WannierIO.write_chk</code></a></li><li><a href="#WannierIO.write_eig-Tuple{AbstractString, AbstractVector}"><code>WannierIO.write_eig</code></a></li><li><a href="#WannierIO.write_mmn"><code>WannierIO.write_mmn</code></a></li><li><a href="#WannierIO.write_nnkp"><code>WannierIO.write_nnkp</code></a></li><li><a href="#WannierIO.write_spn-Union{Tuple{T}, Tuple{AbstractString, AbstractArray{T, 4}}} where T&lt;:Complex"><code>WannierIO.write_spn</code></a></li><li><a href="#WannierIO.write_spn-Union{Tuple{T}, Tuple{AbstractString, AbstractArray{T, 4}, AbstractString}} where T&lt;:Complex"><code>WannierIO.write_spn</code></a></li><li><a href="#WannierIO.write_unk-Tuple{AbstractString, Integer, Array}"><code>WannierIO.write_unk</code></a></li><li><a href="#WannierIO.write_w90_band-Tuple{AbstractString, Vararg{AbstractVector, 5}}"><code>WannierIO.write_w90_band</code></a></li><li><a href="#WannierIO.write_w90_band_dat-Tuple{AbstractString, AbstractVector{&lt;:Real}, AbstractVector{&lt;:AbstractVector{&lt;:Real}}}"><code>WannierIO.write_w90_band_dat</code></a></li><li><a href="#WannierIO.write_w90_band_kpt"><code>WannierIO.write_w90_band_kpt</code></a></li><li><a href="#WannierIO.write_w90_band_labelinfo-Tuple{AbstractString, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:AbstractString}, AbstractVector{&lt;:Real}, AbstractVector{&lt;:StaticArraysCore.SVector{3, &lt;:Real}}}"><code>WannierIO.write_w90_band_labelinfo</code></a></li><li><a href="#WannierIO.write_win-Tuple{AbstractString}"><code>WannierIO.write_win</code></a></li></ul><h2 id="Read/write"><a class="docs-heading-anchor" href="#Read/write">Read/write</a><a id="Read/write-1"></a><a class="docs-heading-anchor-permalink" href="#Read/write" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="WannierIO._fix_win!-Tuple{Dict}" href="#WannierIO._fix_win!-Tuple{Dict}"><code>WannierIO._fix_win!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_fix_win!(params)</code></pre><p>Sanity check and add missing input parameters from a <code>win</code> file.</p><p>See also <a href="#WannierIO.read_win-Tuple{AbstractString}"><code>read_win</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/win.jl#L219-L225">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_win_toml-Tuple{AbstractString}" href="#WannierIO._read_win_toml-Tuple{AbstractString}"><code>WannierIO._read_win_toml</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read a win file in TOML format.</p><p>Used only in tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/win.jl#L414-L418">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_win_toml-Tuple{AbstractString}" href="#WannierIO._write_win_toml-Tuple{AbstractString}"><code>WannierIO._write_win_toml</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write a win file in TOML format.</p><p>Used only in tests. Currently the output file is not formatted nicely.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/win.jl#L462-L467">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_win-Tuple{AbstractString}" href="#WannierIO.read_win-Tuple{AbstractString}"><code>WannierIO.read_win</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_win(filename; fix_inputs=true)</code></pre><p>Read the input file of <code>wannier90</code>.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: The name of the input file.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fix_inputs</code>: sanity check and fix the input parameters, e.g., set   <code>num_bands = num_wann</code> if <code>num_bands</code> is not specified,   convert <code>atoms_cart</code> always to <code>atoms_frac</code>, etc.   See also <a href="#WannierIO._fix_win!-Tuple{Dict}"><code>_fix_win!</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/win.jl#L6-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_win-Tuple{AbstractString}" href="#WannierIO.write_win-Tuple{AbstractString}"><code>WannierIO.write_win</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_win(filename; kwargs...)</code></pre><p>Write input parameters into a wannier90 <code>win</code> file.</p><p>The input parameters are keyword arguments, with key names same as that of wannier90.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using WannierIO

write_win(
    &quot;silicon.win&quot;;
    num_wann=4,
    num_bands=4,
    # unit_cell_cart is a matrix, its columns are the lattice vectors in angstrom
    unit_cell_cart=[
        0.0      2.71527  2.71527
        2.71527  0.0      2.71527
        2.71527  2.71527  0.0
    ],
    # atoms_frac is a vector of pairs of atom_label and fractional coordinates
    atoms_frac=[
        :Si =&gt; [0.0, 0.0, 0.0],
        :Si =&gt; [0.25, 0.25, 0.25],
        # both `:Si` and `&quot;Si&quot;` are allowed
        # &quot;Si&quot; =&gt; [0.25, 0.25, 0.25],
    ],
    # each element in projections will be written as a line in the win file
    projections=[
        &quot;random&quot;,
    ]
    kpoint_path=[
        [:G =&gt; [0.0, 0.0, 0.0], :X =&gt; [0.5, 0.0, 0.5]],
        [:X =&gt; [0.5, 0.0, 0.5], :U =&gt; [0.625, 0.25, 0.625]],
    ],
    mp_grid=[2, 2, 2],
    # kpoints is a matrix, its columns are the fractional coordinates
    kpoints=[
        [0.0, 0.0, 0.0],
        [0.0, 0.0, 0.5],
        [0.0, 0.5, 0.0],
        [0.0, 0.5, 0.5],
        [0.5, 0.0, 0.0],
        [0.5, 0.0, 0.5],
        [0.5, 0.5, 0.0],
        [0.5, 0.5, 0.5],
    ],
    # additional parameters can be passed as keyword arguments, e.g.,
    num_iter=500,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/win.jl#L267-L320">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_wout-Tuple{AbstractString}" href="#WannierIO.read_wout-Tuple{AbstractString}"><code>WannierIO.read_wout</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_wout(filename::AbstractString)</code></pre><p>Parse <code>wout</code> file.</p><p><strong>Return</strong></p><ul><li><code>lattice</code>: in Å, each column is a lattice vector</li><li><code>atom_labels</code>: atomic symbols</li><li><code>atom_positions</code>: in fractional coordinates</li><li><code>centers</code>: WF centers in Å</li><li><code>spreads</code>: WF spreads in Å^2</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/wout.jl#L5-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_amn_bin-Tuple{AbstractString}" href="#WannierIO._read_amn_bin-Tuple{AbstractString}"><code>WannierIO._read_amn_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_read_amn_bin(filename::AbstractString)</code></pre><p>Read Fortran binary (unformatted) <code>amn</code> file.</p><p>Using Fortran stream IO.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L36-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_amn_fmt-Tuple{AbstractString}" href="#WannierIO._read_amn_fmt-Tuple{AbstractString}"><code>WannierIO._read_amn_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_read_amn_fmt(filename::AbstractString)</code></pre><p>Read Fortran formatted <code>amn</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_amn_bin-Tuple{AbstractString, AbstractVector, AbstractString}" href="#WannierIO._write_amn_bin-Tuple{AbstractString, AbstractVector, AbstractString}"><code>WannierIO._write_amn_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write A as Fortran unformatted file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L128-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_amn_fmt-Tuple{AbstractString, AbstractVector, AbstractString}" href="#WannierIO._write_amn_fmt-Tuple{AbstractString, AbstractVector, AbstractString}"><code>WannierIO._write_amn_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write A in plain text format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L102-L104">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_amn-Tuple{AbstractString}" href="#WannierIO.read_amn-Tuple{AbstractString}"><code>WannierIO.read_amn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_amn(filename::AbstractString)</code></pre><p>Read the <code>amn</code> file.</p><p><strong>Return</strong></p><ul><li><code>A</code>: length-<code>n_kpts</code> vector, each element is a <code>n_bands * n_wann</code> matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L74-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_amn-Tuple{AbstractString, AbstractVector, AbstractString}" href="#WannierIO.write_amn-Tuple{AbstractString, AbstractVector, AbstractString}"><code>WannierIO.write_amn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_amn(filename, A, header; binary=false)</code></pre><p>Write <code>amn</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: output filename</li><li><code>A</code>: a length-<code>n_kpts</code> vector, each element is a <code>n_bands * n_wann</code> matrix</li><li><code>header</code>: 1st line of the file</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: write as Fortran unformatted file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L167-L179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_amn-Tuple{AbstractString, AbstractVector}" href="#WannierIO.write_amn-Tuple{AbstractString, AbstractVector}"><code>WannierIO.write_amn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_amn(filename, A)</code></pre><p>Write <code>amn</code> file.</p><p>Default header is <code>Created by WannierIO.jl CURRENT_DATE</code>.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: output filename</li><li><code>A</code>: a length-<code>n_kpts</code> vector, each element is a <code>n_bands * n_wann</code> matrix</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: write as Fortran unformatted file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/amn.jl#L195-L208">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_mmn_bin-Tuple{AbstractString}" href="#WannierIO._read_mmn_bin-Tuple{AbstractString}"><code>WannierIO._read_mmn_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read Fortran binary mmn file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/mmn.jl#L46-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_mmn_fmt-Tuple{AbstractString}" href="#WannierIO._read_mmn_fmt-Tuple{AbstractString}"><code>WannierIO._read_mmn_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read plain text mmn file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/mmn.jl#L5-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_mmn_bin-Tuple{AbstractString, AbstractVector, AbstractVector, AbstractVector, AbstractString}" href="#WannierIO._write_mmn_bin-Tuple{AbstractString, AbstractVector, AbstractVector, AbstractVector, AbstractString}"><code>WannierIO._write_mmn_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write binary mmn file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/mmn.jl#L156-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_mmn_fmt-Tuple{AbstractString, AbstractVector, AbstractVector, AbstractVector, AbstractString}" href="#WannierIO._write_mmn_fmt-Tuple{AbstractString, AbstractVector, AbstractVector, AbstractVector, AbstractString}"><code>WannierIO._write_mmn_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write plain text mmn file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/mmn.jl#L121-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_mmn-Tuple{AbstractString}" href="#WannierIO.read_mmn-Tuple{AbstractString}"><code>WannierIO.read_mmn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_mmn(filename::AbstractString)</code></pre><p>Read <code>mmn</code> file.</p><p><strong>Return</strong></p><ul><li><code>M</code>: length-<code>n_kpts</code> vector of <code>n_bands * n_bands * n_bvecs</code> arrays</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of integers</li><li><code>kpb_b</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of <code>Vec3{Int}</code> for bvectors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/mmn.jl#L90-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_mmn" href="#WannierIO.write_mmn"><code>WannierIO.write_mmn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_mmn(filename, M, kpb_k, kpb_b, header; binary=false)</code></pre><p>Write <code>mmn</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: output file name</li><li><code>M</code>: length-<code>n_kpts</code> vector of <code>n_bands * n_bands * n_bvecs</code> arrays</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of integers</li><li><code>kpb_b</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of <code>Vec3{Int}</code> for bvectors</li><li><code>header</code>: header string</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: if true write in Fortran binary format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/mmn.jl#L204-L218">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_eig_bin-Tuple{AbstractString}" href="#WannierIO._read_eig_bin-Tuple{AbstractString}"><code>WannierIO._read_eig_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read binary eig file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L45-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_eig_fmt-Tuple{AbstractString}" href="#WannierIO._read_eig_fmt-Tuple{AbstractString}"><code>WannierIO._read_eig_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read plain text eig file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L21-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._reshape_eig-Tuple{AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Real}}" href="#WannierIO._reshape_eig-Tuple{AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:Real}}"><code>WannierIO._reshape_eig</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Reshape a vector of eigenvalues into a matrix of eigenvalues.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L5-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_eig_bin-Tuple{AbstractString, AbstractVector}" href="#WannierIO._write_eig_bin-Tuple{AbstractString, AbstractVector}"><code>WannierIO._write_eig_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write binary eig file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L120-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_eig_fmt-Tuple{AbstractString, AbstractVector}" href="#WannierIO._write_eig_fmt-Tuple{AbstractString, AbstractVector}"><code>WannierIO._write_eig_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write plain text eig file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L104-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_eig-Tuple{AbstractString}" href="#WannierIO.read_eig-Tuple{AbstractString}"><code>WannierIO.read_eig</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_eig(filename::AbstractString)</code></pre><p>Read the <code>eig</code> file.</p><p><strong>Return</strong></p><ul><li><code>E</code>: a lenth-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L68-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_eig-Tuple{AbstractString, AbstractVector}" href="#WannierIO.write_eig-Tuple{AbstractString, AbstractVector}"><code>WannierIO.write_eig</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_eig(filename::AbstractString, E::AbstractArray; binary=false)</code></pre><p>Write <code>eig</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>E</code>: a lenth-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: if true write in Fortran binary format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/eig.jl#L141-L151">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_spn-Tuple{AbstractString}" href="#WannierIO.read_spn-Tuple{AbstractString}"><code>WannierIO.read_spn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_spn(filename::AbstractString)</code></pre><p>Read the <code>spn</code> file.</p><p>Return a <code>n_bands * n_bands * n_kpts * 3</code> array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/spn.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_spn-Union{Tuple{T}, Tuple{AbstractString, AbstractArray{T, 4}, AbstractString}} where T&lt;:Complex" href="#WannierIO.write_spn-Union{Tuple{T}, Tuple{AbstractString, AbstractArray{T, 4}, AbstractString}} where T&lt;:Complex"><code>WannierIO.write_spn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_spn(filename::String, S::Array{Complex,4}, header::String)</code></pre><p>Write the <code>spn</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/spn.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_spn-Union{Tuple{T}, Tuple{AbstractString, AbstractArray{T, 4}}} where T&lt;:Complex" href="#WannierIO.write_spn-Union{Tuple{T}, Tuple{AbstractString, AbstractArray{T, 4}}} where T&lt;:Complex"><code>WannierIO.write_spn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_spn(filename::String, S::Array{Complex,4})</code></pre><p>Write the <code>spn</code> file.</p><p>The header is &quot;Created by WannierIO.jl CURRENT_DATE&quot;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/spn.jl#L87-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_unk_bin-Tuple{AbstractString}" href="#WannierIO._read_unk_bin-Tuple{AbstractString}"><code>WannierIO._read_unk_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read binary unk file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/unk.jl#L35-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_unk_fmt-Tuple{AbstractString}" href="#WannierIO._read_unk_fmt-Tuple{AbstractString}"><code>WannierIO._read_unk_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read plain text unk file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/unk.jl#L5-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_unk_bin-Tuple{AbstractString, Integer, Array{&lt;:Complex, 5}}" href="#WannierIO._write_unk_bin-Tuple{AbstractString, Integer, Array{&lt;:Complex, 5}}"><code>WannierIO._write_unk_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write binary unk file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/unk.jl#L118-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_unk_fmt-Tuple{AbstractString, Integer, Array{&lt;:Complex, 5}}" href="#WannierIO._write_unk_fmt-Tuple{AbstractString, Integer, Array{&lt;:Complex, 5}}"><code>WannierIO._write_unk_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write plain text unk file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/unk.jl#L93-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_unk-Tuple{AbstractString}" href="#WannierIO.read_unk-Tuple{AbstractString}"><code>WannierIO.read_unk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_unk(filename::AbstractString)</code></pre><p>Read <code>UNK</code> file for the periodic part of Bloch wavefunctions.</p><p><strong>Return</strong></p><ul><li><code>ik</code>: k-point index</li><li><code>Ψ</code>: periodic part of Bloch wavefunctions in real space,   size = <code>(n_gx, n_gy, n_gz, n_bands, n_spin)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/unk.jl#L61-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_unk-Tuple{AbstractString, Integer, Array}" href="#WannierIO.write_unk-Tuple{AbstractString, Integer, Array}"><code>WannierIO.write_unk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_unk(filename::AbstractString, ik::Integer, Ψ::Array{Complex,4}; binary=false)</code></pre><p>Write <code>UNK</code> file for the periodic part of Bloch wavefunctions.</p><p><strong>Arguments</strong></p><ul><li>ik: at which kpoint? start from 1</li><li>Ψ: Bloch wavefunctions, <code>size(Ψ) = (n_gx, n_gy, n_gz, n_bands, n_spin)</code></li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: write as Fortran unformatted file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/unk.jl#L139-L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_nnkp_toml-Tuple{AbstractString}" href="#WannierIO._read_nnkp_toml-Tuple{AbstractString}"><code>WannierIO._read_nnkp_toml</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read a nnkp file in TOML format.</p><p>Used only in tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/nnkp.jl#L201-L205">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_nnkp_toml-Tuple{AbstractString}" href="#WannierIO._write_nnkp_toml-Tuple{AbstractString}"><code>WannierIO._write_nnkp_toml</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write a nnkp file in TOML format.</p><p>Used only in tests. Internally calls <a href="#WannierIO._write_win_toml-Tuple{AbstractString}"><code>_write_win_toml</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/nnkp.jl#L221-L226">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_nnkp-Tuple{AbstractString}" href="#WannierIO.read_nnkp-Tuple{AbstractString}"><code>WannierIO.read_nnkp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_nnkp(filename::AbstractString)</code></pre><p>Read the <code>nnkp</code> file.</p><p><strong>Return</strong></p><ul><li><code>recip_lattice</code>: each column is a reciprocal lattice vector</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector of <code>Vec3</code>, in fractional coordinates</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of integers, index of kpoints</li><li><code>kpb_b</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of <code>Vec3</code> for bvectors, fractional w.r.t <code>recip_lattice</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/nnkp.jl#L6-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_nnkp" href="#WannierIO.write_nnkp"><code>WannierIO.write_nnkp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_nnkp(filename, bvectors::BVectors, n_wann)</code></pre><p>Write a <code>nnkp</code> file that can be used by DFT codes, e.g., QE <code>pw2wannier90</code>.</p><p><strong>Arguments</strong></p><ul><li><code>recip_lattice</code>: each column is a reciprocal lattice vector</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector of <code>Vec3</code>, in fractional coordinates</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of integers, index of kpoints</li><li><code>kpb_b</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of <code>Vec3</code> for bvectors, fractional w.r.t <code>recip_lattice</code></li><li><code>n_wann</code>: if given, write a <code>auto_projections</code> block</li><li><code>exclude_bands</code>: if given, write the specified band indexes in the <code>exclude_bands</code> block</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Only a preliminary version, use <code>auto_projections</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/nnkp.jl#L95-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.Chk" href="#WannierIO.Chk"><code>WannierIO.Chk</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct for storing matrices in <code>seedname.chk</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L5-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.isapprox-Tuple{WannierIO.Chk, WannierIO.Chk}" href="#Base.isapprox-Tuple{WannierIO.Chk, WannierIO.Chk}"><code>Base.isapprox</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Compare two <code>Chk</code> objects.</p><p>Used in tests.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L689-L693">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_chk_bin-Tuple{AbstractString}" href="#WannierIO._read_chk_bin-Tuple{AbstractString}"><code>WannierIO._read_chk_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read unformatted <code>seedname.chk</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L289-L291">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._read_chk_fmt-Tuple{AbstractString}" href="#WannierIO._read_chk_fmt-Tuple{AbstractString}"><code>WannierIO._read_chk_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Read formatted <code>seedname.chk</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L145-L147">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_chk_bin-Tuple{AbstractString, WannierIO.Chk}" href="#WannierIO._write_chk_bin-Tuple{AbstractString, WannierIO.Chk}"><code>WannierIO._write_chk_bin</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write unformatted <code>chk</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L531-L533">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._write_chk_fmt-Tuple{AbstractString, WannierIO.Chk}" href="#WannierIO._write_chk_fmt-Tuple{AbstractString, WannierIO.Chk}"><code>WannierIO._write_chk_fmt</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Write formatted <code>chk</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L414-L416">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.get_U-Tuple{WannierIO.Chk}" href="#WannierIO.get_U-Tuple{WannierIO.Chk}"><code>WannierIO.get_U</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_U(chk)</code></pre><p>Extract <code>U</code> matrices from <code>Chk</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L631-L635">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.get_Udis-Tuple{WannierIO.Chk}" href="#WannierIO.get_Udis-Tuple{WannierIO.Chk}"><code>WannierIO.get_Udis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_Udis(chk)</code></pre><p>Extract <code>U</code> matrices for disentanglement from <code>Chk</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L649-L653">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_chk-Tuple{AbstractString}" href="#WannierIO.read_chk-Tuple{AbstractString}"><code>WannierIO.read_chk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_chk(filename::AbstractString)</code></pre><p>Read formatted or binary <code>chk</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L398-L402">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_chk-Tuple{AbstractString, WannierIO.Chk}" href="#WannierIO.write_chk-Tuple{AbstractString, WannierIO.Chk}"><code>WannierIO.write_chk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_chk(filename, chk::Chk)</code></pre><p>Write formatted or binary <code>chk</code> file.</p><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: write as Fortran unformatted file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/chk.jl#L611-L618">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_tbdat-Tuple{AbstractString}" href="#WannierIO.read_w90_tbdat-Tuple{AbstractString}"><code>WannierIO.read_w90_tbdat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_tbdat(filename)</code></pre><p>Read <code>seedname_tb.dat</code>.</p><p><strong>Return</strong></p><ul><li><code>lattice</code>: each column is a lattice vector</li><li><code>R</code>: <span>$\bm{R}$</span> vectors on which operators are defined</li><li><code>N</code>: degeneracies of <span>$\bm{R}$</span> vectors</li><li><code>H</code>: Hamiltonian <span>$\bm{H}(\bm{R})$</span></li><li><code>r</code>: position operator</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/tb.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_wsvec-Tuple{AbstractString}" href="#WannierIO.read_w90_wsvec-Tuple{AbstractString}"><code>WannierIO.read_w90_wsvec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_wsvec(filename::AbstractString)</code></pre><p>Read <code>seedname_wsvec.dat</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/tb.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_HH_R-Union{Tuple{IT}, Tuple{T}, Tuple{AbstractString, AbstractArray{T, 3}, AbstractMatrix{IT}}} where {T&lt;:Complex, IT&lt;:Integer}" href="#WannierIO.write_HH_R-Union{Tuple{IT}, Tuple{T}, Tuple{AbstractString, AbstractArray{T, 3}, AbstractMatrix{IT}}} where {T&lt;:Complex, IT&lt;:Integer}"><code>WannierIO.write_HH_R</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_HH_R(filename, H, R; N=nothing, header=nothing)</code></pre><p>Write the real space Hamiltonian to a <code>seedname_HH_R.dat</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: usually <code>seedname_HH_R.dat</code></li><li><code>H</code>: a <code>n_wann * n_wann * n_rvecs</code> array of Hamiltonian</li><li><code>R</code>: a <code>n_rvecs * 3</code> array of integers</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>N</code>: a <code>n_rvecs</code> vector of integers, the degeneracy of each R vector</li><li><code>header</code>: a string, the header of the file</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>Wanier90</code> <code>postw90.x</code> has a hidden input parameter <code>effective_model</code>, setting it to <code>true</code> and <code>postw90.x</code> will read this <code>HH_R.dat</code> to fill the real space Hamiltonian, and do subsequent Wannier interpolation, e.g., in <code>BoltzWann</code>. However, the vanila <code>postw90.x</code> code does not take into account the degeneracy of R vectors, and also does not use MDRS interpolation. I have modified the <code>postw90.x</code> code to use MDRS, and also changed a bit the number of digits for the Hamiltonian in <code>HH_R.dat</code>, so that it is the same as the <code>seedname_tb.dat</code> file, i.e., from Fortran <code>F12.6</code> to <code>E15.8</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/hh_r.jl#L3-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band-Tuple{AbstractString}" href="#WannierIO.read_w90_band-Tuple{AbstractString}"><code>WannierIO.read_w90_band</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band(seedname::AbstractString)</code></pre><p>Read <code>SEEDNAME_band.dat</code>, <code>SEEDNAME_band.kpt</code>, <code>SEEDNAME_band.labelinfo.dat</code>.</p><p><strong>Return</strong></p><ul><li><code>kpoints</code>: <code>3 * n_kpts</code>, fractional coordinates</li><li><code>E</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector of band energies</li><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>symm_idx</code>: index of high-symmetry points in <code>seedname_band.dat</code></li><li><code>symm_label</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L81-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band_dat-Tuple{AbstractString}" href="#WannierIO.read_w90_band_dat-Tuple{AbstractString}"><code>WannierIO.read_w90_band_dat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band_dat(filename)</code></pre><p>Read <code>seedname_band.dat</code> file.</p><p><strong>Return</strong></p><ul><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>E</code>: length-<code>n_kpts</code> vector, each elemnt is a length-<code>n_bands</code> vector of band energies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L26-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band_kpt-Tuple{AbstractString}" href="#WannierIO.read_w90_band_kpt-Tuple{AbstractString}"><code>WannierIO.read_w90_band_kpt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band_kpt(filename)</code></pre><p>Read <code>seedname_band.kpt</code> file.</p><p><strong>Return</strong></p><ul><li><code>kpoints</code>: a vector of length <code>n_kpts</code>, fractional coordinates</li><li><code>weights</code>: a vector of length <code>n_kpts</code>, weights of kpoints</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L6-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band_labelinfo-Tuple{AbstractString}" href="#WannierIO.read_w90_band_labelinfo-Tuple{AbstractString}"><code>WannierIO.read_w90_band_labelinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band_labelinfo(filename::AbstractString)</code></pre><p>Read <code>seedname_band.labelinfo</code> file.</p><p><strong>Return</strong></p><ul><li><code>symm_idx</code>: index of high-symmetry points in <code>seedname_band.dat</code></li><li><code>symm_label</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L55-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band-Tuple{AbstractString, Vararg{AbstractVector, 5}}" href="#WannierIO.write_w90_band-Tuple{AbstractString, Vararg{AbstractVector, 5}}"><code>WannierIO.write_w90_band</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band(seedname, kpoints, E, x, symm_idx, symm_label)</code></pre><p>Write <code>SEEDNAME_band.dat, SEEDNAME_band.kpt, SEEDNAME_band.labelinfo.dat</code>.</p><p><strong>Arguments</strong></p><ul><li><code>seedname</code>: seedname of <code>SEEDNAME_band.dat, SEEDNAME_band.kpt, SEEDNAME_band.labelinfo.dat</code></li><li><code>kpoints</code>: length-<code>n_kpts</code> vector, fractional coordinates</li><li><code>E</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector of band energies</li><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>symm_idx</code>: index of high-symmetry points in <code>seedname_band.dat</code></li><li><code>symm_label</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L199-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band_dat-Tuple{AbstractString, AbstractVector{&lt;:Real}, AbstractVector{&lt;:AbstractVector{&lt;:Real}}}" href="#WannierIO.write_w90_band_dat-Tuple{AbstractString, AbstractVector{&lt;:Real}, AbstractVector{&lt;:AbstractVector{&lt;:Real}}}"><code>WannierIO.write_w90_band_dat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band_dat(filename, x, E)</code></pre><p>Write <code>seedname_band.dat</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: filename of <code>seedname_band.dat</code></li><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>E</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector of band energies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L131-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band_kpt" href="#WannierIO.write_w90_band_kpt"><code>WannierIO.write_w90_band_kpt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_w90_band_kpt(filename, kpoints, weights=nothing)</code></pre><p>Write <code>seedname_band.kpt</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: filename of <code>seedname_band.kpt</code></li><li><code>kpoints</code>: length-<code>n_kpts</code> vector, fractional coordinates</li><li><code>weights</code>: <code>n_kpts</code>, optional, weights of kpoints</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L100-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band_labelinfo-Tuple{AbstractString, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:AbstractString}, AbstractVector{&lt;:Real}, AbstractVector{&lt;:StaticArraysCore.SVector{3, &lt;:Real}}}" href="#WannierIO.write_w90_band_labelinfo-Tuple{AbstractString, AbstractVector{&lt;:Integer}, AbstractVector{&lt;:AbstractString}, AbstractVector{&lt;:Real}, AbstractVector{&lt;:StaticArraysCore.SVector{3, &lt;:Real}}}"><code>WannierIO.write_w90_band_labelinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band_labelinfo(filename, symm_idx, symm_label, x, kpoints)</code></pre><p>Write <code>seedname_band.labelinfo</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: filename of <code>seedname_band.labelinfo</code></li><li><code>symm_idx</code>: index of high-symmetry points in <code>seedname_band.dat</code></li><li><code>symm_label</code>: name of high-symmetry points</li><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector, fractional coordinates</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/7a70c17834e6183042a2735a364f63f50fa9c990/src/w90/band.jl#L161-L172">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../util/">« Utilities</a><a class="docs-footer-nextpage" href="../volumetric/">Volumetric data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 13 July 2023 18:16">Thursday 13 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
