<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wannier90 · WannierIO.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WannierIO.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../convention/">Convention</a></li><li><a class="tocitem" href="../util/">Utilities</a></li><li class="is-active"><a class="tocitem" href>Wannier90</a><ul class="internal"><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Private-API"><span>Private API</span></a></li></ul></li><li><a class="tocitem" href="../volumetric/">Volumetric data</a></li><li><a class="tocitem" href="../qe/">Quantum ESPRESSO</a></li><li><a class="tocitem" href="../">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Wannier90</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wannier90</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/main/docs/src/api/w90.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Wannier90-files"><a class="docs-heading-anchor" href="#Wannier90-files">Wannier90 files</a><a id="Wannier90-files-1"></a><a class="docs-heading-anchor-permalink" href="#Wannier90-files" title="Permalink"></a></h1><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Some of the functions, e.g. <a href="#WannierIO.read_amn"><code>read_amn</code></a>, <a href="#WannierIO.write_amn"><code>write_amn</code></a>, <a href="#WannierIO.read_chk-Tuple{AbstractString, WannierIO.FortranText}"><code>read_chk</code></a>, <a href="#WannierIO.write_chk"><code>write_chk</code></a>, etc., support reading/writing Fortran unformatted files. However, the Fortran unformatted files are machine and compiler dependent. Therefore, it is not guaranteed that these functions work for all the cases. Currently, the functions are tested on the following platforms:</p><ul><li>Linux + gfortran 11.2</li></ul></div></div><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_amn" href="#WannierIO.read_amn"><code>WannierIO.read_amn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_amn(filename)
read_amn(filename, ::FortranText)
read_amn(filename, ::FortranBinaryStream)</code></pre><p>Read wannier90 <code>amn</code> file.</p><p><strong>Return</strong></p><ul><li><code>A</code>: length-<code>n_kpts</code> vector, each element is a <code>n_bands * n_wann</code> matrix.</li><li><code>header</code>: first line of the file</li></ul><p>Note there are three versions of this function: the 1st one is a wrapper function that automatically detect the format (text or binary) of the file, and does some additional pretty printing to give user a quick hint of the dimensions of the A matrix; it internally calls the 2nd or the 3rd version for actual reading.</p><p>Wannier90 only has Fortran text format for <code>amn</code>, however I wrote a custom version of QE pw2wannier90.x that can output Fortran binary format (using Fortran stream IO) to save some disk space. The 1st function auto detect the file format so it is transparent to the user.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/amn.jl#L3-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_amn" href="#WannierIO.write_amn"><code>WannierIO.write_amn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_amn(filename, A; header=default_header(), binary=false)
write_amn(filename, A, ::FortranText; header=default_header())
write_amn(filename, A, ::FortranBinaryStream; header=default_header())</code></pre><p>Write wannier90 <code>amn</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: output filename</li><li><code>A</code>: a length-<code>n_kpts</code> vector, each element is a <code>n_bands * n_wann</code> matrix</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>header</code>: 1st line of the file</li><li><code>binary</code>: write as Fortran unformatted file, which is the Wannier90 default.   Here the <code>binary</code> kwargs is provided for convenience.</li></ul><p>Same as <a href="#WannierIO.read_amn"><code>read_amn</code></a> there are three versions of this function, the 1st one is a wrapper function, it calls the 2nd or the 3rd version depending on the <code>binary</code> kwargs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/amn.jl#L102-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band-Tuple{AbstractString}" href="#WannierIO.read_w90_band-Tuple{AbstractString}"><code>WannierIO.read_w90_band</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band(prefix)
</code></pre><p>Read <code>prefix_band.dat</code>, <code>prefix_band.kpt</code>, <code>prefix_band.labelinfo.dat</code>.</p><p><strong>Arguments</strong></p><ul><li><code>prefix</code>: <em>prefix</em> of the filenames (or called seedname in wannier90), NOT the full filename.</li></ul><p><strong>Return</strong></p><ul><li><code>x</code>: <code>n_kpts</code>, x axis value of kpath, in cartesian length</li><li><code>eigenvalues</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector of band energies</li><li><code>kpoints</code>: a vector of length <code>n_kpts</code>, fractional coordinates</li><li><code>kweights</code>: a vector of length <code>n_kpts</code>, weights of kpoints</li><li><code>symm_point_indices</code>: index of high-symmetry points in <code>prefix_band.dat</code></li><li><code>symm_point_labels</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L102-L117">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band_dat-Tuple{AbstractString}" href="#WannierIO.read_w90_band_dat-Tuple{AbstractString}"><code>WannierIO.read_w90_band_dat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band_dat(filename)
</code></pre><p>Read <code>prefix_band.dat</code> file generated by <code>wannier90.x</code>, or <code>prefix-band.dat</code> file generated by <code>postw90.x</code>.</p><p><strong>Return</strong></p><ul><li><code>x</code>: <code>n_kpts</code>, x axis value of kpath, in cartesian length</li><li><code>eigenvalues</code>: length-<code>n_kpts</code> vector, each elemnt is a length-<code>n_bands</code> vector   of band energies</li><li><code>extras</code>: optional (the <code>postw90.x</code> might generate a file with a third column),   same size as <code>eigenvalues</code>, often the color of each eigenvalue,   e.g., spin projection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L32-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band_kpt-Tuple{AbstractString}" href="#WannierIO.read_w90_band_kpt-Tuple{AbstractString}"><code>WannierIO.read_w90_band_kpt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band_kpt(filename)
</code></pre><p>Read a <code>prefix_band.kpt</code> file.</p><p><strong>Return</strong></p><ul><li><code>kpoints</code>: a vector of length <code>n_kpts</code>, fractional coordinates</li><li><code>kweights</code>: a vector of length <code>n_kpts</code>, weights of kpoints</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L12-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_band_labelinfo-Tuple{AbstractString}" href="#WannierIO.read_w90_band_labelinfo-Tuple{AbstractString}"><code>WannierIO.read_w90_band_labelinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_band_labelinfo(filename)
</code></pre><p>Read <code>prefix_band.labelinfo</code> file.</p><p><strong>Return</strong></p><ul><li><code>symm_point_indices</code>: index of high-symmetry points in <code>prefix_band.dat</code></li><li><code>symm_point_labels</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L76-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band-Tuple{AbstractString}" href="#WannierIO.write_w90_band-Tuple{AbstractString}"><code>WannierIO.write_w90_band</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band(
    prefix;
    x,
    eigenvalues,
    kpoints,
    kweights,
    symm_point_indices,
    symm_point_labels
)
</code></pre><p>Write <code>prefix_band.dat, prefix_band.kpt, prefix_band.labelinfo.dat</code>.</p><p><strong>Arguments</strong></p><ul><li><code>prefix</code>: prefix of <code>prefix_band.dat, prefix_band.kpt, prefix_band.labelinfo.dat</code></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>eigenvalues</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector of band energies</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector, fractional coordinates</li><li><code>kweights</code>: a vector of length <code>n_kpts</code>, weights of kpoints</li><li><code>symm_point_indices</code>: index of high-symmetry points in <code>prefix_band.dat</code></li><li><code>symm_point_labels</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L259-L274">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band_dat-Tuple{AbstractString}" href="#WannierIO.write_w90_band_dat-Tuple{AbstractString}"><code>WannierIO.write_w90_band_dat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band_dat(filename; x, eigenvalues, extras)
</code></pre><p>Write <code>prefix_band.dat</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: filename of <code>prefix_band.dat</code></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>x</code>: <code>n_kpts</code>, x axis value, in cartesian length</li><li><code>eigenvalues</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code>   vector of band energies</li><li><code>extras</code>: optional, same size as <code>eigenvalues</code>, will be written as the third   column of <code>prefix_band.dat</code>. The <code>prefix-band.dat</code> file generated by   <code>postw90.x</code> sometimes has a third column for e.g. the color of the eigenvalues</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L170-L185">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band_kpt-Tuple{AbstractString}" href="#WannierIO.write_w90_band_kpt-Tuple{AbstractString}"><code>WannierIO.write_w90_band_kpt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band_kpt(filename; kpoints, kweights)
</code></pre><p>Write <code>prefix_band.kpt</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: filename of <code>prefix_band.kpt</code></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kpoints</code>: length-<code>n_kpts</code> vector, fractional coordinates</li><li><code>kweights</code>: <code>n_kpts</code>, optional, weights of kpoints, default to 1.0.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L141-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_band_labelinfo-Tuple{AbstractString}" href="#WannierIO.write_w90_band_labelinfo-Tuple{AbstractString}"><code>WannierIO.write_w90_band_labelinfo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_band_labelinfo(
    filename;
    x,
    kpoints,
    symm_point_indices,
    symm_point_labels
)
</code></pre><p>Write <code>prefix_band.labelinfo</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: filename of <code>prefix_band.labelinfo</code></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>x</code>: <code>n_kpts</code>-vector, x axis value, in cartesian length</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector, fractional coordinates</li><li><code>symm_point_indices</code>: index of high-symmetry points in <code>prefix_band.dat</code></li><li><code>symm_point_labels</code>: name of high-symmetry points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L217-L230">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.get_U-Tuple{WannierIO.Chk}" href="#WannierIO.get_U-Tuple{WannierIO.Chk}"><code>WannierIO.get_U</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_U(chk)
</code></pre><p>Extract the combined <code>U = Udis * Uml</code> matrices from <code>Chk</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L671-L675">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.get_Udis-Tuple{WannierIO.Chk}" href="#WannierIO.get_Udis-Tuple{WannierIO.Chk}"><code>WannierIO.get_Udis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_Udis(chk)
</code></pre><p>Extract disentanglement <code>Udis</code> matrices from <code>Chk</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L688-L692">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_chk-Tuple{AbstractString, WannierIO.FortranText}" href="#WannierIO.read_chk-Tuple{AbstractString, WannierIO.FortranText}"><code>WannierIO.read_chk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_chk(filename)
read_chk(filename, ::FortranText)
read_chk(filename, ::FortranBinary)</code></pre><p>Read wannier90 <code>chk</code> checkpoint file.</p><p>Similar to <a href="#WannierIO.read_amn"><code>read_amn</code></a>, the 1st version auto detect <code>chk</code> file format (binary or text) and read it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L175-L184">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_chk" href="#WannierIO.write_chk"><code>WannierIO.write_chk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_chk(filename, chk::Chk; binary=false)
write_chk(filename, chk::Chk, ::FortranText)
write_chk(filename, chk::Chk, ::FortranBinary)</code></pre><p>Write wannier90 <code>chk</code> file.</p><p>Similar to <a href="#WannierIO.write_amn"><code>write_amn</code></a>, the 1st version is a convenience wrapper.</p><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: write as Fortran binary file or not. Although wannier90 default   is Fortran binary format, here the default is <code>false</code> since Fortran binary   depends on compiler and platform, so it is not guaranteed to always work.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L446-L459">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_eig" href="#WannierIO.read_eig"><code>WannierIO.read_eig</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_eig(filename)
read_eig(filename, ::FortranText)
read_eig(filename, ::FortranBinaryStream)</code></pre><p>Read the wannier90 <code>eig</code> file.</p><p><strong>Return</strong></p><ul><li><code>eigenvalues</code>: a lenth-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector</li></ul><p>The 1st version is a convenience wrapper function for the 2nd and 3rd versions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/eig.jl#L37-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_eig" href="#WannierIO.write_eig"><code>WannierIO.write_eig</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_eig(filename, eigenvalues; binary=false)
write_eig(filename, eigenvalues, ::FortranText)
write_eig(filename, eigenvalues, ::FortranBinaryStream)</code></pre><p>Write <code>eig</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>eigenvalues</code>: a length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: if true write in Fortran binary format.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/eig.jl#L110-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_hrdat-Tuple{AbstractString}" href="#WannierIO.read_w90_hrdat-Tuple{AbstractString}"><code>WannierIO.read_w90_hrdat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_hrdat(filename)
</code></pre><p>Read <code>prefix_hr.dat</code>.</p><p><strong>Return</strong></p><ul><li><code>Rvectors</code>: <span>$\mathbf{R}$</span>-vectors on which operators are defined</li><li><code>Rdegens</code>: degeneracies of each <span>$\mathbf{R}$</span>-vector</li><li><code>H</code>: Hamiltonian <span>$\mathbf{H}(\mathbf{R})$</span></li><li><code>header</code>: the first line of the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/hr.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_hrdat-Tuple{AbstractString}" href="#WannierIO.write_w90_hrdat-Tuple{AbstractString}"><code>WannierIO.write_w90_hrdat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_hrdat(filename; Rvectors, Rdegens, H, header)
</code></pre><p>Write <code>prefix_hr.dat</code>.</p><p><strong>Keyword arguments</strong></p><p>See the return values of <a href="#WannierIO.read_w90_hrdat-Tuple{AbstractString}"><code>read_w90_hrdat</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/hr.jl#L40-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_mmn" href="#WannierIO.read_mmn"><code>WannierIO.read_mmn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_mmn(filename)
read_mmn(filename, ::FortranText)
read_mmn(filename, ::FortranBinaryStream)</code></pre><p>Read wannier90 <code>mmn</code> file.</p><p><strong>Return</strong></p><ul><li><code>M</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bvecs</code> vector, then   each element is a <code>n_bands * n_bands</code> matrix</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bvecs</code> vector of   integers for the indices of the neighboring kpoints</li><li><code>kpb_G</code>: length-<code>n_kpts</code> vector, each element is a lenght-<code>n_bvecs</code> vector of   of <code>Vec3{Int}</code>, which are the translation vectors</li><li><code>header</code>: 1st line of the file</li></ul><p>The translation vector <code>G</code> is defined as <code>b = kpoints[kpb_k[ik][ib]] + kpb_G[ik][ib] - kpoints[ik]</code>, where <code>b</code> is the <code>ib</code>-th bvector of the <code>ik</code>-th kpoint.</p><p>The 1st version is a convenience wrapper for the other two.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/mmn.jl#L3-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_mmn" href="#WannierIO.write_mmn"><code>WannierIO.write_mmn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_mmn(filename; M, kpb_k, kpb_G; header=default_header(), binary=false)
write_mmn(filename; M, kpb_k, kpb_G, ::FortranText; header=default_header(), binary=false)
write_mmn(filename; M, kpb_k, kpb_G, ::FortranBinaryStream; header=default_header(), binary=false)</code></pre><p>Write wannier90 <code>mmn</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: output file name</li><li><code>M</code>: length-<code>n_kpts</code> vector of <code>n_bands * n_bands * n_bvecs</code> arrays</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of integers</li><li><code>kpb_G</code>: length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector of <code>Vec3{Int}</code> for bvectors</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>header</code>: header string</li><li><code>binary</code>: if true write in Fortran binary format</li></ul><p>The 1st version is a convenience wrapper for the other two.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/mmn.jl#L127-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_nnkp" href="#WannierIO.read_nnkp"><code>WannierIO.read_nnkp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_nnkp(filename)
read_nnkp(filename, ::Wannier90Text)
read_nnkp(filename, ::Wannier90Toml)</code></pre><p>Read wannier90 <code>nnkp</code> file.</p><p><strong>Return</strong></p><ul><li><code>lattice</code>: each column is a lattice vector</li><li><code>recip_lattice</code>: each column is a reciprocal lattice vector</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector, each element is <code>Vec3</code>, in fractional coordinates</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bvecs</code> vector of   integers, index of kpoints</li><li><code>kpb_G</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bvecs</code> vector,   then each element is <code>Vec3</code> for translations, fractional w.r.t <code>recip_lattice</code></li></ul><p>Wannier90 <code>nnkp</code> file is a plain text format, the 2nd version reads <code>nnkp</code> file in Wannier90 format. The thrid version read a TOML-format <code>nnkp</code> file, which is defined by this package, see <a href="#WannierIO.write_nnkp"><code>write_nnkp</code></a>. The 1st version auto detects the format and parse it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/nnkp.jl#L3-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_nnkp" href="#WannierIO.write_nnkp"><code>WannierIO.write_nnkp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_nnkp(filename; toml=false, kwargs...)
write_nnkp(filename, ::Wannier90Text; kwargs...)
write_nnkp(filename, ::Wannier90Toml; kwargs...)</code></pre><p>Write a <code>nnkp</code> file that can be used by DFT codes, e.g., QE <code>pw2wannier90</code>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>toml</code>: write to a TOML file, otherwise write to a Wannier90 text file format</li><li><code>recip_lattice</code>: each column is a reciprocal lattice vector</li><li><code>kpoints</code>: length-<code>n_kpts</code> vector of <code>Vec3</code>, in fractional coordinates</li><li><code>kpb_k</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bvecs</code> vector of   integers, index of kpoints</li><li><code>kpb_G</code>: length-<code>n_kpts</code> vector, each element is a length-<code>n_bvecs</code> vector,   then each element is a <code>Vec3</code> for translation vector, fractional w.r.t. <code>recip_lattice</code></li><li><code>n_wann</code>: if given, write an <code>auto_projections</code> block</li><li><code>exclude_bands</code>: if given, write the specified band indices in the <code>exclude_bands</code> block</li><li><code>header</code>: first line of the file</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Only use <code>auto_projections</code>, the <code>projections</code> block is not supported.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/nnkp.jl#L151-L173">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_rdat-Tuple{AbstractString}" href="#WannierIO.read_w90_rdat-Tuple{AbstractString}"><code>WannierIO.read_w90_rdat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_rdat(filename)
</code></pre><p>Read <code>prefix_r.dat</code>.</p><p><strong>Return</strong></p><ul><li><code>Rvectors</code>: <span>$\mathbf{R}$</span>-vectors on which operators are defined</li><li><code>r_x</code>: <span>$x$</span>-component of position operator</li><li><code>r_y</code>: <span>$y$</span>-component of position operator</li><li><code>r_z</code>: <span>$z$</span>-component of position operator</li><li><code>header</code>: the first line of the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/r.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_spn" href="#WannierIO.read_spn"><code>WannierIO.read_spn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_spn(filename)
read_spn(filename, ::FortranText)
read_spn(filename, ::FortranBinary)</code></pre><p>Read the wannier90 <code>spn</code> file.</p><p><strong>Return</strong></p><ul><li><code>Sx</code>: spin x, a length-<code>n_kpts</code> vector, each element is a <code>n_bands</code>-by-<code>n_bands</code> matrix</li><li><code>Sy</code>: spin y, a length-<code>n_kpts</code> vector, each element is a <code>n_bands</code>-by-<code>n_bands</code> matrix</li><li><code>Sz</code>: spin z, a length-<code>n_kpts</code> vector, each element is a <code>n_bands</code>-by-<code>n_bands</code> matrix</li><li><code>header</code>: 1st line of the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/spn.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_spn" href="#WannierIO.write_spn"><code>WannierIO.write_spn</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_spn(filename, Sx, Sy, Sz; binary=false, header)
write_spn(filename, Sx, Sy, Sz, ::FortranText; header)
write_spn(filename, Sx, Sy, Sz, ::FortranBinary; header)</code></pre><p>Write the <code>spn</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/spn.jl#L110-L116">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_tbdat-Tuple{AbstractString}" href="#WannierIO.read_w90_tbdat-Tuple{AbstractString}"><code>WannierIO.read_w90_tbdat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_tbdat(filename)
</code></pre><p>Read <code>prefix_tb.dat</code>.</p><p><strong>Return</strong></p><ul><li><code>lattice</code>: each column is a lattice vector in Å</li><li><code>Rvectors</code>: <span>$\mathbf{R}$</span>-vectors on which operators are defined</li><li><code>Rdegens</code>: degeneracies of each <span>$\mathbf{R}$</span>-vector</li><li><code>H</code>: Hamiltonian <span>$\mathbf{H}(\mathbf{R})$</span></li><li><code>r_x</code>: <span>$x$</span>-component of position operator</li><li><code>r_x</code>: <span>$y$</span>-component of position operator</li><li><code>r_x</code>: <span>$z$</span>-component of position operator</li><li><code>header</code>: the first line of the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/tb.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_tbdat-Tuple{AbstractString}" href="#WannierIO.write_w90_tbdat-Tuple{AbstractString}"><code>WannierIO.write_w90_tbdat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_tbdat(
    filename;
    lattice,
    Rvectors,
    Rdegens,
    H,
    r_x,
    r_y,
    r_z,
    header
)
</code></pre><p>Write <code>prefix_tb.dat</code>.</p><p><strong>Keyword arguments</strong></p><p>See the return values of <a href="#WannierIO.read_w90_tbdat-Tuple{AbstractString}"><code>read_w90_tbdat</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/tb.jl#L85-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_uHu" href="#WannierIO.read_uHu"><code>WannierIO.read_uHu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_uHu(filename)
read_uHu(filename, ::FortranText; transpose_band_indices=true)
read_uHu(filename, ::FortranBinary; transpose_band_indices=true)</code></pre><p>Read the wannier90 <code>uHu</code> file.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>transpose_band_indices</code>: QE pw2wannier90.x writes the matrix in a strange   transposed manner; if reading a QE-generated <code>uHu</code> file, this flag should   be true to restore the band indices order, so that the returned matrix   has the correct order, i.e.,   <code>uHu[ik][ib1, ib2][m, n]</code> is   <span>$\langle u_{m, k + b_1}| H | u_{n, k + b_2} \rangle$</span></li></ul><p><strong>Return</strong></p><ul><li><code>uHu</code>: a length-<code>n_kpts</code> vector, each element is a <code>n_bvecs * n_bvecs</code> matrix,   then each element is a  <code>n_bands * n_bands</code> matrix</li><li><code>header</code>: 1st line of the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/uHu.jl#L3-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_uHu" href="#WannierIO.write_uHu"><code>WannierIO.write_uHu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_uHu(filename, uHu; binary=false, header)
write_uHu(filename, uHu, ::FortranText; header)
write_uHu(filename, uHu, ::FortranBinary; header)</code></pre><p>Write the <code>uHu</code> file.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>transpose_band_indices</code>: see <a href="#WannierIO.read_uHu"><code>read_uHu</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/uHu.jl#L112-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_unk" href="#WannierIO.read_unk"><code>WannierIO.read_unk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_unk(filename)
read_unk(filename, ::FortranText)
read_unk(filename, ::FortranBinary)</code></pre><p>Read wannier90 <code>UNK</code> file for the periodic part of Bloch wavefunctions.</p><p><strong>Return</strong></p><ul><li><code>ik</code>: k-point index, start from 1</li><li><code>Ψ</code>: periodic part of Bloch wavefunctions in real space,   size = <code>(n_gx, n_gy, n_gz, n_bands, n_spin)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/unk.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_unk" href="#WannierIO.write_unk"><code>WannierIO.write_unk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_unk(filename, ik, Ψ; binary=false)
write_unk(filename, ik, Ψ, ::FortranText)
write_unk(filename, ik, Ψ, ::FortranBinary)</code></pre><p>Write <code>UNK</code> file for the periodic part of Bloch wavefunctions.</p><p><strong>Arguments</strong></p><ul><li>ik: at which kpoint? start from 1</li><li>Ψ: Bloch wavefunctions, <code>size(Ψ) = (n_gx, n_gy, n_gz, n_bands, n_spin)</code></li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>binary</code>: write as Fortran unformatted file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/unk.jl#L84-L97">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_win" href="#WannierIO.read_win"><code>WannierIO.read_win</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_win(filename; fix_inputs=true)
read_win(filename, ::Wannier90Text; fix_inputs=true)
read_win(filename, ::Wannier90Toml; fix_inputs=true)</code></pre><p>Read wannier90 input <code>win</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: The name of the input file.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fix_inputs</code>: sanity check and fix the input parameters, e.g., set   <code>num_bands = num_wann</code> if <code>num_bands</code> is not specified,   convert <code>atoms_cart</code> always to <code>atoms_frac</code>, etc.   See also <a href="#WannierIO.fix_win!-Tuple{Dict}"><code>fix_win!</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/win.jl#L5-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_win" href="#WannierIO.write_win"><code>WannierIO.write_win</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_win(filename; toml=false, kwargs...)
write_win(filename, ::Wannier90Text; kwargs...)
write_win(filename, ::Wannier90Toml; kwargs...)</code></pre><p>Write input parameters into a wannier90 <code>win</code> file.</p><p>The input parameters are keyword arguments, with key names same as that of wannier90.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using WannierIO

write_win(
    &quot;silicon.win&quot;;
    num_wann=4,
    num_bands=4,
    # unit_cell_cart is a matrix, its columns are the lattice vectors in angstrom
    unit_cell_cart=[
        0.0      2.71527  2.71527
        2.71527  0.0      2.71527
        2.71527  2.71527  0.0
    ],
    # atoms_frac is a vector of pairs of atom_label and fractional coordinates
    atoms_frac=[
        :Si =&gt; [0.0, 0.0, 0.0],
        :Si =&gt; [0.25, 0.25, 0.25],
        # both `:Si` and `&quot;Si&quot;` are allowed
        # &quot;Si&quot; =&gt; [0.25, 0.25, 0.25],
    ],
    # each element in projections will be written as a line in the win file
    projections=[
        &quot;random&quot;,
    ]
    kpoint_path=[
        [:G =&gt; [0.0, 0.0, 0.0], :X =&gt; [0.5, 0.0, 0.5]],
        [:X =&gt; [0.5, 0.0, 0.5], :U =&gt; [0.625, 0.25, 0.625]],
    ],
    mp_grid=[2, 2, 2],
    # kpoints is a matrix, its columns are the fractional coordinates
    kpoints=[
        [0.0, 0.0, 0.0],
        [0.0, 0.0, 0.5],
        [0.0, 0.5, 0.0],
        [0.0, 0.5, 0.5],
        [0.5, 0.0, 0.0],
        [0.5, 0.0, 0.5],
        [0.5, 0.5, 0.0],
        [0.5, 0.5, 0.5],
    ],
    # additional parameters can be passed as keyword arguments, e.g.,
    num_iter=500,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/win.jl#L365-L420">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_wout-Tuple{AbstractString}" href="#WannierIO.read_wout-Tuple{AbstractString}"><code>WannierIO.read_wout</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_wout(filename)
</code></pre><p>Parse wannire90 <code>wout</code> file.</p><p><strong>Return</strong></p><ul><li><code>lattice</code>: each column is a lattice vector in Å</li><li><code>recip_lattice</code>: each column is a reciprocal lattice vector in Å⁻¹</li><li><code>atom_labels</code>: atomic symbols</li><li><code>atom_positions</code>: in fractional coordinates</li><li><code>centers</code>: final each WF centers in Å</li><li><code>spreads</code>: final each WF spreads in Å²</li><li><code>ΩI</code>, <code>ΩD</code>, <code>ΩOD</code>, <code>Ωtotal</code>: final spread (components) in Å²</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/wout.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.read_w90_wsvec-Tuple{AbstractString}" href="#WannierIO.read_w90_wsvec-Tuple{AbstractString}"><code>WannierIO.read_w90_wsvec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_w90_wsvec(filename)
</code></pre><p>Read <code>prefix_wsvec.dat</code>.</p><p><strong>Return</strong></p><ul><li><code>mdrs</code>: whether use MDRS interpolation, i.e. the <code>use_ws_distance</code> in the header</li><li><code>Rvectors</code>: the <span>$\mathbf{R}$</span>-vectors</li><li><code>Tvectors</code>: the <span>$\mathbf{T}_{m n \mathbf{R}}$</span>-vectors.   Returned only <code>mdrs = true</code>.</li><li><code>Tdegens</code>: the degeneracies of <span>$\mathbf{T}_{m n \mathbf{R}}$</span>-vectors.   Returned only <code>mdrs = true</code>.</li><li><code>n_wann</code>: number of WFs</li><li><code>header</code>: the first line of the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/wsvec.jl#L3-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_w90_wsvec-Tuple{AbstractString}" href="#WannierIO.write_w90_wsvec-Tuple{AbstractString}"><code>WannierIO.write_w90_wsvec</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_w90_wsvec(
    filename;
    Rvectors,
    n_wann,
    Tvectors,
    Tdegens,
    header
)
</code></pre><p>Write <code>prefix_wsvec.dat</code>.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>n_wann</code>: for Wigner-Seitz Rvectors, needs to provide a <code>n_wann</code> for number of   Wannier functions; for MDRS Rvectors, the <code>n_wann</code> is optional and can be   automatically determined from the <code>Tvectors</code></li><li><code>Tvectors</code> and <code>Tdegens</code>: if provided, write in MDRS format; otherwise, write in   Wigner-Seitz format</li></ul><p>Also see the return values of <a href="#WannierIO.read_w90_wsvec-Tuple{AbstractString}"><code>read_w90_wsvec</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/wsvec.jl#L101-L113">source</a></section></article><h2 id="Private-API"><a class="docs-heading-anchor" href="#Private-API">Private API</a><a id="Private-API-1"></a><a class="docs-heading-anchor-permalink" href="#Private-API" title="Permalink"></a></h2><p>These are some lower-level types/functions that are (probably) less used, thus not exported. Of course, you can still use them by prefixing <code>WannierIO.</code>, e.g., <code>WannierIO.read_w90_band_dat(filename)</code>.</p><article class="docstring"><header><a class="docstring-binding" id="WannierIO.default_band_kpt_kweights-Tuple{AbstractVector}" href="#WannierIO.default_band_kpt_kweights-Tuple{AbstractVector}"><code>WannierIO.default_band_kpt_kweights</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">default_band_kpt_kweights(kpoints)
</code></pre><p>Wannier90 default kweights in <code>prefix_band.kpt</code> is all 1.0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/band.jl#L134-L138">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.Chk" href="#WannierIO.Chk"><code>WannierIO.Chk</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct for storing matrices in <code>prefix.chk</code> file.</p><pre><code class="language-julia hljs">struct Chk{T&lt;:Real}</code></pre><p>One-to-one mapping to the wannier90 <code>chk</code> file, but renaming the variable names so that they are consistent with the rest of the code.</p><p><strong>Fields</strong></p><ul><li><p><code>header</code>: The header line, usually contains date and time</p></li><li><p><code>n_bands</code>: number of bands, can be auto set in constructor according to dimensions of other variables</p></li><li><p><code>n_exclude_bands</code>: number of excluded bands, can be auto set in constructor</p></li><li><p><code>exclude_bands</code>: Indices of excluded bands, starts from 1. Vector of integers, size: <code>n_exclude_bands</code></p></li><li><p><code>lattice</code>: Matrix of size 3 x 3, each column is a lattice vector in Å unit</p></li><li><p><code>recip_lattice</code>: Matrix of size 3 x 3, each column is a reciprocal lattice vector in Å⁻¹ unit</p></li><li><p><code>n_kpts</code>: number of kpoints, can be auto set in constructor</p></li><li><p><code>kgrid</code>: dimensions of kpoint grid, 3 integers</p></li><li><p><code>kpoints</code>: kpoint coordinates, fractional, length-<code>n_kpts</code> vector</p></li><li><p><code>n_bvecs</code>: number of b-vectors, can be auto set in constructor</p></li><li><p><code>n_wann</code>: number of Wannier functions, can be auto set in constructor</p></li><li><p><code>checkpoint</code>: a string to indicate the current step (after disentanglement, after maximal localization, ...) in wannier90</p></li><li><p><code>have_disentangled</code>: Have finished disentanglement or not</p></li><li><p><code>ΩI</code>: Omega invariant part of MV spreads, in Å² unit</p></li><li><p><code>dis_bands</code>: Indices of bands taking part in disentanglement, not frozen bands! length-<code>n_kpts</code> vector, each element is a length-<code>n_bands</code> vector of bool.</p><p>This is needed since W90 puts all the disentanglement bands in the first several rows of <code>Udis</code>, (and the first few columns of <code>Udis</code> are the frozen bands) so directly multiplying eigenvalues e.g. <code>(Udis * U)&#39; * diag(eigenvalues) * (Udis * U)</code> is wrong!</p></li></ul><ul><li><p><code>n_dis</code>: number of bands taking part in disentanglement at each kpoint. can be auto set in constructor from <code>dis_bands</code></p></li><li><p><code>Udis</code>: Semi-unitary matrix for disentanglement, length-<code>n_kpts</code> vector, each elment has size: <code>n_bands</code> x <code>n_wann</code>, i.e., the <code>u_matrix_opt</code> in wannier90</p></li><li><p><code>Uml</code>: Unitary matrix for maximal localization, length-<code>n_kpts</code> vector, each element has size: <code>n_wann</code> x <code>n_wann</code>, i.e., the <code>u_matrix</code> in wannier90. The abbreviation <code>ml</code> stands for maximal localization, so as to differentiate from the (combined) unitary matrix <code>U = Udis * Uml</code>.</p></li><li><p><code>M</code>: Wannier-gauge overlap matrix, length-<code>n_kpts</code> vector of length-<code>n_bvecs</code> vector, each element is a matrix of size <code>n_wann</code> x <code>n_wann</code>, i.e., the <code>m_matrix</code> in wannier90</p></li><li><p><code>r</code>: Wannier function centers, length-<code>n_wann</code> vector, Cartesian coordinates in Å unit, i.e., the <code>wannier_centres</code> variable in wannier90</p></li><li><p><code>ω</code>: Wannier function spreads, length-<code>n_wann</code> vector, Å² unit, i.e., the <code>wannier_spreads</code> variable in wannier90</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.Chk-Tuple{AbstractString, AbstractVector{Int64}, AbstractMatrix, AbstractMatrix, AbstractVector{&lt;:Integer}, AbstractVector, AbstractString, Bool, Real, AbstractVector{BitVector}, Vararg{AbstractVector, 5}}" href="#WannierIO.Chk-Tuple{AbstractString, AbstractVector{Int64}, AbstractMatrix, AbstractMatrix, AbstractVector{&lt;:Integer}, AbstractVector, AbstractString, Bool, Real, AbstractVector{BitVector}, Vararg{AbstractVector, 5}}"><code>WannierIO.Chk</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Chk(
    header,
    exclude_bands,
    lattice,
    recip_lattice,
    kgrid,
    kpoints,
    checkpoint,
    have_disentangled,
    ΩI,
    dis_bands,
    Udis,
    Uml,
    M,
    r,
    ω
)
</code></pre><p>Convenience constructor of <a href="#WannierIO.Chk"><code>Chk</code></a> struct that auto set some fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.isapprox-Tuple{WannierIO.Chk, WannierIO.Chk}" href="#Base.isapprox-Tuple{WannierIO.Chk, WannierIO.Chk}"><code>Base.isapprox</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isapprox(a, b)
</code></pre><p>Compare two <code>Chk</code> objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/chk.jl#L728-L732">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._check_eig_order-Tuple{AbstractVector}" href="#WannierIO._check_eig_order-Tuple{AbstractVector}"><code>WannierIO._check_eig_order</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_check_eig_order(eigenvalues; digits)
</code></pre><p>Check that eigenvalues are in order.</p><p>Some times there are small noises, use <code>digits</code> to set the number of digits for comparisons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/eig.jl#L21-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._reshape_eig-Tuple{AbstractVector, AbstractVector, AbstractVector}" href="#WannierIO._reshape_eig-Tuple{AbstractVector, AbstractVector, AbstractVector}"><code>WannierIO._reshape_eig</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_reshape_eig(idx_b, idx_k, eig)
</code></pre><p>Reshape a vector of eigenvalues into a matrix of eigenvalues.</p><p>Auto detect the number of bands and kpoints.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/eig.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.write_HH_R-Union{Tuple{IT}, Tuple{T}, Tuple{AbstractString, AbstractArray{T, 3}, AbstractMatrix{IT}}} where {T&lt;:Complex, IT&lt;:Integer}" href="#WannierIO.write_HH_R-Union{Tuple{IT}, Tuple{T}, Tuple{AbstractString, AbstractArray{T, 3}, AbstractMatrix{IT}}} where {T&lt;:Complex, IT&lt;:Integer}"><code>WannierIO.write_HH_R</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_HH_R(filename, H, R; N, header)
</code></pre><p>Write the real space Hamiltonian to a <code>prefix_HH_R.dat</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: usually <code>prefix_HH_R.dat</code></li><li><code>H</code>: a <code>n_wann * n_wann * n_rvecs</code> array of Hamiltonian</li><li><code>R</code>: a <code>n_rvecs * 3</code> array of integers</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>N</code>: a <code>n_rvecs</code> vector of integers, the degeneracy of each R vector</li><li><code>header</code>: a string, the header of the file</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>Wanier90</code> <code>postw90.x</code> has a hidden input parameter <code>effective_model</code>, setting it to <code>true</code> and <code>postw90.x</code> will read this <code>HH_R.dat</code> to fill the real space Hamiltonian, and do subsequent Wannier interpolation, e.g., in <code>BoltzWann</code>. However, the vanila <code>postw90.x</code> code does not take into account the degeneracy of R vectors, and also does not use MDRS interpolation. I have modified the <code>postw90.x</code> code to use MDRS, and also changed a bit the number of digits for the Hamiltonian in <code>HH_R.dat</code>, so that it is the same as the <code>prefix_tb.dat</code> file, i.e., from Fortran <code>F12.6</code> to <code>E15.8</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/hh_r.jl#L3-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._check_dimensions_M_kpb-Tuple{Any, Any, Any}" href="#WannierIO._check_dimensions_M_kpb-Tuple{Any, Any, Any}"><code>WannierIO._check_dimensions_M_kpb</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_check_dimensions_M_kpb(M, kpb_k, kpb_G)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/mmn.jl#L164-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._check_dimensions_kpb-Tuple{Any, Any}" href="#WannierIO._check_dimensions_kpb-Tuple{Any, Any}"><code>WannierIO._check_dimensions_kpb</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Check the dimensions between the quantities are consistent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/mmn.jl#L148-L150">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._check_dimensions_Sx_Sy_Sz-Tuple{Any, Any, Any}" href="#WannierIO._check_dimensions_Sx_Sy_Sz-Tuple{Any, Any, Any}"><code>WannierIO._check_dimensions_Sx_Sy_Sz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_check_dimensions_Sx_Sy_Sz(Sx, Sy, Sz)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/spn.jl#L119-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO._check_win_required_params-Tuple{Any}" href="#WannierIO._check_win_required_params-Tuple{Any}"><code>WannierIO._check_win_required_params</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_check_win_required_params(kwargs)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/win.jl#L423-L425">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="WannierIO.fix_win!-Tuple{Dict}" href="#WannierIO.fix_win!-Tuple{Dict}"><code>WannierIO.fix_win!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fix_win!(params)
</code></pre><p>Sanity check and add missing input parameters from a <code>win</code> file.</p><p>See also <a href="#WannierIO.read_win"><code>read_win</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/WannierIO.jl/blob/445d6a02c5343b76aebd81cdf77817811148e9f0/src/w90/win.jl#L317-L323">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../util/">« Utilities</a><a class="docs-footer-nextpage" href="../volumetric/">Volumetric data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 7 September 2023 13:38">Thursday 7 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
